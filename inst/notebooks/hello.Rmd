---
title: "hello.c"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## The C code
This is _hello.c_:
```
    #include <R.h>

    void hello(int *n)
    {
    int i;
    
    for(i=0; i < *n; i++) {
       Rprintf("Hello, world!\n");
    }
    }
```

Compile from the terminal with:

    $ R CMD SHLIB hello.c
    
```{r}
dir("../../src", pattern = "hello.*")
```

    
```{r}
system("R CMD SHLIB ../../src/hello.c")
dir("../../src", pattern = "hello.*")
```

A file _hello.so_ will be generated.

## The wrapper
We write an R function to wrap the loading and call to hello.so:
```{r}
dyn.load("../../src/hello.dll")

hello <- function(n) {
  .C("hello", as.integer(n))
}

hello(7)
```

## Calling from R

From R:
```{r, comment=NA}
source("R/hello.R")     #: load the R wrapper
hello(7)
```


